apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainvalidator1validator-node
  namespace: supplychain-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainvalidator1validator-node
  chart:
    git: https://github.com/jagpreetsinghsasan/bevel.git
    ref: localtest
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://6804cea61a04f4deba0cdec9e6ce774516d154d9519c14e253553e7937a21c577e0a49f08d2041516c49ee6e32599fc67609990a9f589f2406fd6975f019fa5d@validator1.supplychain-bes.svc.cluster.local:30303"
      
      - "enode://cfd78f4764711a4fed8cd8a2cd5323bc01923160ed67e022bb44f78825f431ff636399c948f2eb4d3cbc3f724d52822c68ee98f47d91a12713e865858f07054f@validator2.supplychain-bes.svc.cluster.local:30303"
      
      - "enode://bbdfbed54b6b1c16db5ed0beff500bc496292a1320455afcbf12ef349b03a7c7a82c4f0ee1a33cdf799f5cdda7fcca0fa04d39c3f99dc195447b085d98081446@validator3.supplychain-bes.svc.cluster.local:30303"
      
      - "enode://c288c1e3757360c2efb0a33cd2a4cb81bb65367f695267e27a7c66f95219bcdf39d2b8d89ffe8af28e439902e46b6d21a1c244d9573634922d5920f86fc98446@validator4.supplychain-bes.svc.cluster.local:30303"
      
      - "enode://56294a56d34e3701c54f717ac589bdb82211c751049b49f969c859b0773f1230a14c357242758b8b78941e602a53a45016e1fa4e96dd9c1432d6da7f1d6136fc@carrier.carrier-bes.svc.cluster.local:30303"
      
      - "enode://8a62b1c59bfe02361bcf7f9609d44decb8f4ac6887e197e90a00bc954192d9c5f8f6db63984dd172fafabb59fe28665c54027f83d2109ecf51de357ca6418fd7@manufacturer.manufacturer-bes.svc.cluster.local:30303"
      
      - "enode://391233fd21fea08fd98564a407e0c86b76aeeff9c6eb5753002f401a0bbfcebbe256e14ce826e2f09cc8d0009631238ebb8890c316b694822ef19dc3ac6075b0@store.store-bes.svc.cluster.local:30303"
      
      - "enode://f0b5252a72eb0ede123d5fac2f3184202a7c6e3257aac64e34fec3cc5dc7f0df02480d6f499796b4bda14e5d77cd5957470cba207427281e4d67696090ec260c@warehouse.warehouse-bes.svc.cluster.local:30303"
      

    metadata:
      namespace: supplychain-bes
      labels:

    ambassador:
      external_url_suffix: supplychain-bes.svc.cluster.local

    liveliness_check:
      enabled: false
      
    proxy:
      provider: none
      external_url: supplychain.supplychain-bes
      p2p: 30303
      rpc: 8545

    images:
      node: hyperledger/besu:21.10.6
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator1
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: minikubestorageclass
      storagesize: 1Gi

    vault:
      address: http://192.168.1.10:8200
      secretprefix: secretsv2/data/supplychain-bes/crypto/validator1
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychain

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDE5OTI0N2ZkNDAxMmJlODc1YTVkMTc4Yzg0NGNhNjA4OTQ5MzE0YjQ5NGRiZGJhMTU1NzIyODEwNjhhZDkxNWYzNjhhNGQxZmEyMzkwZmRlOGQ5NGZkMzc2YWJiYTk1NzdhMzk2MmE4MDZlZjVjYjNmYjU3OTM2NWUyYWE5NDM5ZTlhZDI4ZjNjZjhlYjc1OGJjZDE3YzQ2NmQyM2VhMDgwODkxY2Q4MDg0MDAwMDAwMDBjMCIKfQ==
